<div class="test-notification-container">
  <h3>ğŸ”” Test Push Notifications</h3>
  
  <div class="button-group">
    <button class="btn-test" (click)="testNotification()">
      ğŸ”” Test Instant Notification
    </button>
    
    <button class="btn-push" (click)="enablePush()" [disabled]="!pushSupported">
      ğŸ“² Enable Push (FCM)
    </button>
    
    <button class="btn-attach" (click)="attachForeground()">
      ğŸ–¼ï¸ Attach Foreground Handler
    </button>
  </div>
  
  <div class="info-box">
    <p style="margin-top: 10px;"><strong>âš™ï¸ How Push Notifications Work:</strong></p>
    <ol>
      <li>Create a notification with time in <strong>HH:mm</strong> format (e.g., 14:30 for 2:30 PM)</li>
      <li>Select which days of the week (0=Sunday, 1=Monday, etc.)</li>
      <li>When created, an immediate push is sent to all your devices</li>
      <li>At the scheduled time, another push is sent automatically via Cloud Functions</li>
      <li><strong>Works even when app is closed!</strong> Push notifications are delivered by the server</li>
    </ol>
    <div class="push-status">
      <p><strong>Push Status:</strong></p>
      <ul>
        <li>Support: {{ pushSupported ? 'âœ… Supported' : 'âŒ Not supported' }}</li>
        <li>VAPID Key: {{ vapidConfigured ? 'âœ… Configured' : 'âŒ Missing' }}</li>
        <li>Permission: {{ notificationPermission }}</li>
        <li>FCM Token: <span *ngIf="fcmToken; else noToken">{{ fcmToken }}</span><ng-template #noToken>Not registered</ng-template></li>
      </ul>
    </div>
  </div>
  
  <div class="help-text" *ngIf="notificationPermission === 'denied'">
    <p class="error-text">
      âš ï¸ <strong>Notifications are BLOCKED!</strong> Enable them:
    </p>
    <ul>
      <li><strong>Chrome/Edge:</strong> Click ğŸ”’ in address bar â†’ Site settings â†’ Notifications â†’ Allow</li>
      <li><strong>Firefox:</strong> Click â“˜ in address bar â†’ Permissions â†’ Notifications â†’ Allow</li>
    </ul>
    <button class="btn-retry" (click)="testNotification()">Retry Permission Request</button>
  </div>
</div>
